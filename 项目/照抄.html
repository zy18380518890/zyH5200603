<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title></title>
		<link rel="stylesheet" href="reset.css">
		<link rel="stylesheet" type="text/css" href="index1.css"/>
		
	</head>
	<body>
		<div class="wrap">
			<header class="header">
				<div class="top">
					<div class="container">
						<div class="login">
						<p>尚品汇欢迎您！</p>
						<p>
							<span>请</span>
							<a href="#">登录</a>
							<a class="register" href="#">免费注册</a>
						</p>
						</div>
					
					<div class="headerNav">
						<a href="#">我的订单</a>
						<a href="#">我的购物车</a>
						<a href="#">尚品汇会员</a>
						<a href="#">企业采购</a>
						<a href="#">关注尚品汇</a>
						<a href="#">合作招商</a>
						<a href="#">商家后台</a>
					</div>
				</div>
			</div>	
				<div class="bottom">
					<h1 class="logoArea">
						<a href="#"><img src="../images/Logo.png" alt=""></a>
					</h1>
					<div class="searchArea">
						<form action="">
							
						<input type="text">
						<button>搜索</button>
						</form>
					</div>
				</div>
				
			</header>
			
			<div class="typeNav">
				<div class="container">
					<h2 class="all">全部商品分类</h2>
					<nav>
						<a href="#">服装城</a>
						<a href="#">美妆馆</a>
						<a href="#">尚品汇超市</a>
						<a href="#">全球购</a>
						<a href="#">闪购</a>
						<a href="#">团购</a>
						<a href="#">有趣</a>
						<a href="#">秒杀</a>
					</nav>
				</div>
			</div>
			
			<section class="con">
				<div class="conPain">
					<!-- <a href="#">手机、数码、通讯</a>
					<a href="#">手机</a>
					<a href="#">Apple苹果</a>
					<a>iphone 6s系类</a> -->
				</div>
				<div class="mainCon">
					<div class="previewWrap">
						<div class="preview">
							<div class="zoom">
								<img src="../images/s1.png" alt="">
							</div>
						</div>
						<div class="specScroll">
							<a class="prev">&lt;</a>
							<div class="itemCon">
								<ul class="list">
									<li><img src="../images/s1.png" alt=""></li>
									<li><img src="../images/s2.png" alt=""></li>
									<li><img src="../images/s3.png" alt=""></li>
									<li><img src="../images/s1.png" alt=""></li>
									<li><img src="../images/s2.png" alt=""></li>
									<li><img src="../images/s3.png" alt=""></li>
									<li><img src="../images/s1.png" alt=""></li>
									<li><img src="../images/s2.png" alt=""></li>
									
								</ul>
							</div>
							<a class="next">&gt;</a>
						</div>
					</div>
					<div class="infoWrap">
						<div class="infol">
							<!-- <h3 class="infoName">Apple iPhone 6s（A1700）64G玫瑰金色 移动通信电信4G手机</h3>
							<p class="news">推荐选择下方[移动优惠购],手机套餐齐搞定,不用换号,每月还有话费返</p>
							<div class="priceArea">
								<div class="priceArea1">
									<div class="title">价&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;格</div>
									<div class="price">
										<i>￥</i>
										<em>5299</em>
										<span>降价通知</span>
									</div>
									<div class="remark">
										<i>累计评价</i>
										<span>15365</span>
									</div>
								</div>
								<div class="priceArea2">
									<div class="title">支&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;持</div>
									<div class="fixWidth">
										<i>加价购</i>
										<span>满999.00另加20.00元，或满1999.00另加30.00元，或满2999.00另加40.00元，即可在购物车换购热销商品</span>
										
									</div>
								</div>
							</div>
							<div class="support">
								<div>
									<div class="title">支&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;持</div>
									<div class="fixWidth">广东省 深圳市 宝安区</div>
								</div>
							</div> -->
						</div>
						
						<div class="choose">
							<div class="chooseArea">
							   <div class="choosed">
								   
							   </div>			
						
						</div>
								
						
							<div class="carWrap">
								<div class="controls">
									<input type="text" value="1">
									<a href="#" class="plus">+</a>
									<a href="#" class="mins">-</a>
								</div>
								<div class="addBtn">
									<a href="#">加入购物车</a>
								</div>
							</div>
						</div>
					</div>
					
				</div>
			</section>
		</div>
		<script type="text/javascript" src="data.js"></script>
		
		<script type="text/javascript">
			window.addEventListener('DOMContentLoaded',function(){
				var magnifierImgId=0;
				var changeNum=1;
				magnifier();
				
				function magnifier(){
					var imgSrc=[
						 { b: "../images/b1.png", s: "../images/s1.png" },
						 { b: "../images/b2.png", s: "../images/s2.png" },
						 { b: "../images/b3.png", s: "../images/s3.png" },
						 { b: "../images/b1.png", s: "../images/s1.png" },
						 { b: "../images/b2.png", s: "../images/s2.png" },
						 { b: "../images/b3.png", s: "../images/s3.png" },
						 { b: "../images/b1.png", s: "../images/s1.png" },
						 { b: "../images/b2.png", s: "../images/s2.png"},
					]
					var smallImg=document.querySelector('.wrap .con .mainCon .previewWrap .preview .zoom>img');
					smallImg.src=imgSrc[magnifierImgId].s;
					
					var preview=document.querySelector('.wrap .con .mainCon .previewWrap .preview' );
					var smallBox=document.querySelector('.wrap .con .mainCon .previewWrap .preview .zoom' );
					var mask=null;
					var bigBox=null;
					var bigImg=null;
					preview.onmouseenter =function(){
						if(!mask){
						mask=document.createElement('div');
						mask.className='mask';
						smallBox.appendChild(mask);
						
						bigBox =document.createElement('div');
						bigBox.className='bigBox';
						bigImg=new Image();
						bigImg.src=imgSrc[magnifierImgId].b;
						bigBox.appendChild(bigImg);
						preview.appendChild(bigBox);
						
						}
						smallBox.onmousemove =function(event){
							var maskPosition={
								left:event.clientX-mask.offsetWidth/2-smallBox.getBoundingClientRect().left,
								top:event.clientY-mask.offsetHeight/2-smallBox.getBoundingClientRect().top,
								}
							    if(maskPosition.left<0){
									maskPosition.left=0;
								}else if(maskPosition.left>smallBox.clientWidth-mask.offsetWidth){
									maskPosition.left=smallBox.clientWidth-mask.offsetWidth;
								}
							
							      if(maskPosition.top<0){
									  maskPosition.top=0
								  }else if(maskPosition.top>smallBox.clientWidth-mask.offsetHeight){
									  maskPosition.top=smallBox.clientWidth-mask.offsetHeight;
								  }
							   mask.style.left=maskPosition.left+'px';
							   mask.style.top=maskPosition.top+'px';
							   
							   var scale=(smallBox.clientWidth-mask.offsetWidth)/(bigImg.offsetWidth-bigBox.clientWidth);
							   var bigPosition={
								   left:maskPosition.left/scale,
								   top:maskPosition.top/scale,
								   
							   }
							   bigImg.style.marginLeft =-bigPosition.left+'px';
							   bigImg.style.marginTop =-bigPosition.top+'px';
							   
							   
							}
							
						preview.onmouseleave =function(){
							smallBox.removeChild(mask);
							preview.removeChild(bigBox);
							mask=null;
							bigBox=null;
							bigImg=null;
							
						    smallBox.onmousemove=null;
							preview.onmouseleve=null;
							
						}
					}


			} 
			function getStyle(obj,attr){
				if(obj.currentStyle){
					return obj.currentStyle[attr];
				}else{
					return document.defaultView.getComputedStyle(obj,null)[attr];
				}
			}
			
			//点击完成切换
			thumbnail();
			function thumbnail(){
				var listNode=document.querySelector('.wrap .con .mainCon .previewWrap .specScroll .itemCon .list');
				var items =document.querySelectorAll('.wrap .con .mainCon .previewWrap .specScroll .itemCon .list>li');
				var prev =document.querySelector('.wrap .con .mainCon .previewWrap .specScroll .prev');
				var next=document.querySelector('.wrap .con .mainCon .previewWrap .specScroll .next');
				//获取固定图片张数
				var imgNum=5;
				//图片右边距
				var imgRight=parseInt(getStyle(items[0],'marginRight'));
				//总共可以移动距离
				var tempWidth=(items.length-imgNum)*(items[0].offsetWidth+imgRight);
				//每次移动两张图片
				
				var imgMove=2;
				var moveLeft=(items[0].offsetWidth+imgRight)*imgMove;
				//初始位置
				var tempLeft=0;
				next.onclick =function(){
					if(tempLeft<tempWidth){
						if(tempWidth-tempLeft>moveLeft){
							tempLeft+=moveLeft;
							
						}else{
							tempLeft+=(tempWidth-tempLeft);
						}
						
						listNode.style.left=-tempLeft+'px';
					}
					
					
				};
				
				prev.onclick =function(){
					if(tempLeft>0){
						if(tempLeft>moveLeft){
							tempLeft-=moveLeft;
						}else{
							tempLeft=0;
						}
						listNode.style.left=-tempLeft+'px';
					}
				}
				
				
			}
			
			//点击缩略图切换图片
			thumbnailClick();
			function thumbnailClick(){
				var smallImg=document.querySelector('.wrap .con .mainCon .previewWrap .preview .zoom>img');
				var imgItem =document.querySelectorAll('.wrap .con .mainCon .previewWrap .specScroll .itemCon .list>li>img');
				for(var i=0; i<imgItem.length; i++){
					imgItem[i].onclick =function(){
						for(var i=0; i<imgItem.length; i++){
							if(imgItem[i]==this){
								magnifierImgId=i;
								smallImg.src=this.src;
							}
						}
					}
				}
			}
			
			//商品筛选详情
			screening();
			function screening(){
				var crumbData =goodData.goodsDetail.crumbData;
				
				var chooseArea=document.querySelector('.wrap .con .mainCon .infoWrap .choose .chooseArea');
				 
				 crumbData.forEach(function(item){
				    
				    var dlNode=document.createElement('dl');
				    var dtNode=document.createElement('dt');
					dtNode.innerHTML=item.title;
					dlNode.appendChild(dtNode);
					
					item.data.forEach(function(item){
					
					var ddNode=document.createElement('dd');
					ddNode.innerHTML=item.type;
					ddNode.setAttribute('changePrice',item.changePrice);
					dlNode.appendChild(ddNode);
					
				 });
				 chooseArea.appendChild(dlNode);
				 })
				 
				 //筛选内容的交互代码
				 var dlList=chooseArea.getElementsByTagName('dl');
				 var arr=[];
				 var arr =new Array(crumbData.length);
				 arr.fill(0);
				 
				 for(var i=0; i<dlList.length; i++){
					 dlList[i].index=i;
					 (function(){
						 var ddList=dlList[i].getElementsByTagName('dd');
						 for(var j=0; j<ddList.length; j++){
							 ddList[j].onclick=function(){
								 for(var i=0; i<ddList.length; i++){
								    ddList[i].style.color='#666';
								     
								}	 
								this.style.color='red';
								
								arr[this.parentNode.index]=this.innerHTML;
								var choosed=document.querySelector('.wrap .con .mainCon .infoWrap .choose .chooseArea .choosed');
								choosed.innerHTML='';
								arr.forEach(function(item,index){
									if(item){
										var markNode=document.createElement('mark');
										markNode.innerHTML=item;
										var aNode=document.createElement('a');
										aNode.innerHTML='X';
										aNode.setAttribute('num',index);
										markNode.appendChild(aNode);
										choosed.appendChild(markNode);
									}
								})
								//删除功能
								var aNode=choosed.querySelectorAll('mark>a')
								for(var i=0; i<aNode.length; i++){
									aNode[i].onclick =function(){
										var num=parseInt(this.getAttribute('num'));
										this.parentNode.parentNode.removeChild(this.parentNode);
										var ddList=dlList[num].querySelectorAll('dd');
										for(var i=0; i<ddList.length; i++){
											ddList[i].style.color='#666';
										}
										dlList[num].querySelector('dd:nth-of-type(1)').style.color='red';
										arr[num]=0;
									}
									
								}
							 }
						 }
					 })();
				 }
				 //计算价钱函数
				 function priceSum(arr){
					 var newPrice =goodData.goodsDetail.price*changeNum;
					 arr.forEach(function(item){
						 newPrice+=parseInt(item.getAttribute('changePrice'))*changeNum;
						 
					 })
					 var priceNode=document.querySelector(''.wrap .con .mainCon .infoWrap .info1 .priceArea .priceArea1 .price ');
					 priceNode.innerHTML=newPrice;
					
					 
				 }
				 
			}
			//商品数量交互
			goodsNum();
			function goodsNum(){
				var plusNode=document.querySelector('.wrap .con .mainCon .infoWrap .choose .carWrap .controls .plus');
				var minsNode=document.querySelector('.wrap .con .mainCon .infoWrap .choose .carWrap .controls .mins');
				var inputNode=document.querySelector('.wrap .con .mainCon .infoWrap .choose .carWrap .controls input');
				
				
				plusNode.onclick =function(){
					changeNum++;
					inputNode.value=changeNum;
					var priceNode=document.querySelector('.wrap .con .mainCon .infoWrap .info1 .priceArea .priceArea1 .price ');
					var priceEnd=priceNode.innerHTML/(changeNum-1)*changeNum;
					priceNode.innerHTML =priceEnd;
				}
				minsNode.onclick =function(){
					if(changeNum>1){
						changeNum--;
						inputNode.value=changeNum;
						var priceNode=document.querySelector('.wrap .con .mainCon .infoWrap .info1 .priceArea .priceArea1 .price ');
						var priceEnd =priceNode.innerHTML/(changeNum+1)*changeNum;
						priceNode.innerHTML =priceEnd;
					}
				}
				
			}
			
			//商品详情的数据动态生成
		     goodsDetail();
			 function goodsDetail(){
				 var goodsData=goodData.goodsDetail;
				 var infolNode =document.querySelector('.wrap .con .mainCon .infoWrap .infol');
				 var str=`<h3 class="infoName">${goodsData.title}</h3>
                        <p class="news">${goodsData.recommend}</p>
                        <div class="priceArea">
                            <div class="priceArea1">
                                <div class="title">价&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;格</div>
                                <div class="price">
                                    <i>￥</i>
                                    <em>${goodsData.price}</em>
                                    <span>降价通知</span>
                                </div>
                                <div class="remark">
                                    <i>累计评价</i>
                                    <span>${goodsData.evaluateNum}</span>
                                </div>
                            </div>
                            <div class="priceArea2">
                                <div class="title">促&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;销</div>
                                <div class="fixWidth">
                                    <i>${goodsData.promoteSales.type}</i>
                                    <span>${goodsData.promoteSales.content}</span>
                                </div>
                            </div>
                        </div>
                        <div class="support">
                            <div>
                                <div class="title">支&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;持</div>
                                <div class="fixWidth">${goodsData.support}</div>
                            </div>
                            <div>
                                <div class="title">配&nbsp;送&nbsp;至</div>
                                <div class="fixWidth">${goodsData.address}</div>
                            </div>
                        </div>`;
						infolNode.innerHTML=str;
			 }
			
			
			//路径动态生成
			pathUrl();
			function pathUrl(){
				var conPain =document.querySelector('.wrap .con .conPain');
				var pathData=goodData.path;
				pathData.forEach(function(item,index){
					var aNode=document.createElement('a');
					if(index==item.length-1){
						aNode.innerHTML=item.title;
						conPain.appendChild(aNode);
					}else{
						aNode.innerHTML=item.title;
						aNode.href=item.url;
						conPain.appendChild(aNode);
					}
				})

	
			}
			})
		</script>
	</body>
	
</html>